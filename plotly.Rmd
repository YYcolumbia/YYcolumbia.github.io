---
title: "Plotly"
output: 
  html_document:
    toc: true
    toc_float: true
---

# Problem 2

Create a flexdashboard using plotly for that includes at least three distinct plot types (e.g. scatterplots, line plots, bar plots, box plots, etc.) using `Instacart` dataset from the `p8105.datasets` package.

Load packages and data:

```{r setup, include = FALSE}
library(tidyverse)
library(p8105.datasets)

library(plotly)
```

Import `Instacart` dataset and filter data:

```{r}
data("instacart")

instacart = 
  instacart %>% 
  as_tibble(instacart) %>%
  janitor::clean_names() %>%
  select(add_to_cart_order, order_dow, order_hour_of_day, aisle)
```

## Plotly barplot: Number of items ordered in each aisle

```{r}
instacart %>%
  count(aisle) %>%
  filter(n > 5000) %>%
  mutate(aisle = fct_reorder(aisle, n)) %>%
  plot_ly(x = ~aisle, y = ~n, color = ~aisle, type = "bar", colors = "viridis")
```

## Plotly scatterplot: Order hour of day for different types of Aisle sorted by weekday

```{r}
instacart %>%
  sample_n(1000) %>%
  group_by(aisle) %>%
  mutate(text_label = str_c("Aisle: ", aisle, "\nOrder Time: ", order_hour_of_day, ":00")) %>% 
  plot_ly(
    x = ~aisle, y = ~order_hour_of_day, type = "scatter", mode = "markers",
    color = ~order_dow, text = ~text_label, alpha = 0.5)
```